pipeline {

	agent any

	stages {
	
		stage("build"){
			
			steps {
				echo 'Building step'
			}

		}
	stage("tests"){	
		parallel{
			stage("test_unit"){
				steps {
					echo 'unit 1'
					// sleep 10
					export TEST_VAR_X="test"
					echo 'unit 2'
				}

			}
			stage("test_e2e"){
				steps {
					echo 'e2e 1'
					// sleep 3 

					echo 'e2e 2'
				}

			}
		}
	}
		
		stage("clean-up"){
			
			steps {
			
				echo 'Cleaning step'
				echo 'echoing TEST_VAR'
				echo $TEST_VAR
			}

		}

	}


}
