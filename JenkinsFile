pipeline {

	agent any

matrix {
    axes {
        axis {
            name 'PYTHON_VERSION_ENV'
            values 'py38', 'py39', 'py310'
        }
    }
	stages {
	
		stage("build"){
			
			steps {
				echo 'Building step'
			}

		}
	stage("tests"){	
		parallel{
			stage("test_unit"){
				steps {
					echo 'unit 1'
					// sleep 10
					bat ''' 
					set TEST_VAR=1
					echo off
					echo "TEST_VAR is: " %TEST_VAR%
					'''

					echo 'unit 2'
				}

			}
			stage("test_e2e"){
				steps {
					echo 'e2e 1'
					// sleep 3 

					echo 'e2e 2'
				}

			}
		}
	}
		
		stage("clean-up"){
			
			steps {
			
				echo 'Cleaning step'
				echo 'echoing TEST_VAR'
				bat ''' echo off
				echo "TEST_VAR is: " %TEST_VAR%
				'''
			}

		}

	}


}
}
